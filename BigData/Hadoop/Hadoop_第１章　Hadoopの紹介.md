# 分散大規模データ処理システム -- Hadoop-1

# 第１章　Hadoopの紹介

## Hadoopとは

　　HadoopはApache基金会によって開発された分散システムの基盤となるソフトウェアフレームワークです。これはストレージシステムと計算フレームワークを組み合わせて複数のコンピュータをクラスター化にし、大規模データについて保存と処理の問題を解決することを目的としている。

**ような問題を解決**

- 大規模データの保存：高い耐障害性を備えて複数の低コストのハードウェア（hardware）上で大量データの保存を実現する。且つデータへには高いスループット（throughput）も提供して高速化にデータを訪問することができる。


- 資源の管理、スケジューリング：汎用の資源管理システム及びスケジューリングプシステムでで、Hadoopだけではない、上層の他のアプリケーションを一元化にされた資源管理とスケジューリングの効用を提供する。クラスタの利用率、資源の統合管理、データの共有などの面で大きな利点がもたらされました。

- 分散型計算：複雑な大量の計算任務を多数の部分に分解し、異なる節点に割り当てて並行処理を行い、その結果を集約して最終的な出力を得るものです。その流れにクラスターの計算能力とストレージ空間を効果的に活用し、データ処理の効率と信頼性を高めることがある。

**Hadoopの特徴**

利点

- データの保存と処理能力において高い信頼性を持っている。
-  利用可能なコンピュータクラスターを通じてデータを分配し、保存と計算のタスクを完了する。これらのクラスターは数千の節点まで簡単に拡張することができ、高い拡張性を持っている。 
- 節点の間でデータを動的に移動させ、各節点の負荷を動的にバランスさせることができる。処理速度は非常に速く、高い効率性がある。 
- データの複数のコピーを自動的に保存し、失敗したタスクを自動的に再配分することができる。これにより、高い耐障害性を持っています。

欠点

- 低遅延でのデータ訪問には適してない。
- 大量の小さなファイルを効率的に保存することができない。 
- 複数のユーザーによる書き込みやファイルの任意の変更を支持してない。

**Hadoopの生態**

　　Hadoopの狭義には上記の通り分散システムのソフトウェアフレームワークものです。広義には、Hadoopは複数のビッグデータ技術を代表して、他のソフトウェアと組み合わせて共に整体のビッグデータ技術生態に築いてくれ、これらの色々なソフトウェアの間に依頼の関係もあるんです。つまり、一旦ビッグデータ領域に入って、学習せざるを得ない内容があんまり多いことが知っておくはずです。

![Top Big Data Tools for Developers & Data Analysts](D:\OneDrive\picture\Typora\BigData\Hadoop\hadoop-768x402.jpg)

## Hadoopの仕組み

　　Hadoopは核心の三つ部分（HDFS、MapReduce、YARN）やCommon共用部分を共に組み合わせる。以下は各部分の働きを大体に紹介します。

**HDFS**

　　Hadoop HDFS（Hadoop Distributed File System）とは高い信頼性と高いスループットを持って分散ファイルシステムです。基本構造は主従結構（master-slave architecture）に従ってNameNodeとDataNodeを主従節点に分けます。NameNodeはファイルのメタデータを管理します。DataNodeは、データの実体を保存します。 HDFSにファイルが一定サイズで分割されてデータブロック（date block）としてDataNodeに保存します。

![image-20240311155255355](D:\OneDrive\picture\Typora\BigData\Hadoop\image-20240311155255355.png)

- NameNode（nn）：全てのクラスタのメタデータ（Mate Data）格納の所です。例えばファイル名、ファイルの目録構造、ファイル属性（作成時間、副本数、ファイル権限）や各ファイルのブロックリストとそのブロックが存在するDataNodeなど情報を保存します。 
- SecondaryNameNode（2nn）：NameNodeの作業を支持するために、HDFSの状態を監視する補助プログラムで、一定の時間ごとにHDFSのメタデータのスナップショット（snapshot）を取得します。 
- DataNode（dn）：実際データブロックを格納する所です。同時にデータブロックの検証、更新などなど役も担当します。

**MapReduce**

　　MapReduceはHadoopのデータ計算を担当する役で、複数のサーバで大規模のデータを並行に処理できるソフトウェアフレームワークです。

　　MapReduceフレームワークは<キー, 値>ペアに基づいてデータの処理を行います。MapReduceの核心設定は一つのMapReduce Jobを分割Mapと併合Reduceという2種類の流れに分けて実行します。例えば、年の時間を条件としてデータを分割し、最後の処理結果が複数のファイル形式で出て条件に適当の計算結果を一つのファイルに格納されます。そのような一つのファイルが一つのMapReduce Jobの結果を代表し、あと、MapReduce Job単位にはユーザーが需要に応じて設定することもできます。

![img](D:\OneDrive\picture\Typora\BigData\Hadoop\apache-hadoop-mapreduce.jpg)

**YARN**

　　YARNは、Hadoop V2.0から単独の部分としてあって、計算資源のスケジューリングを提供し、YARNにリソースを要求するとそのリソースを割り当てる役割を果たすフレームワークです。

![hadoop-yarn-architecture-1](D:\OneDrive\picture\Typora\BigData\Hadoop\hadoop-yarn-architecture-1.jpg)

　　YARNは実行中のプログラムと完全に分けられており、計算の内容には触れないでYARN上でさまざまな種類の分散計算プログラムを実行することができます。例えば、MapReduce、Storm、Spark、Tezなどが含まれます。SparkやStormなどの計算フレームワークはYARN規格に適合したリソース要求の仕組みを持っていれば、YARN上で統合して実行できます。つまり、汎用的なリソーススケジューリングのフレームワークとして使われることがあります。

![HadoopYarn](D:\OneDrive\picture\Typora\BigData\Hadoop\HadoopYarn-1717450127465-2.jpg)

- ResourceManager (RM): クライアントのリクエストを処理し、ApplicationMasterの起動/監視、NodeManagerの監視、資源の割り当てとスケジューリングを行います。
- NodeManager (NM): 各節点上のリソースを管理し、ResourceManagerからの命令を処理し、ApplicationMasterからの命令も処理します。
- ApplicationMaster (AM): データの分割、アプリケーションのための資源を要求し、内部タスクに資源を割り当て、タスクの監視とフォールトトレランス（fault tolerance）を担当します。
- Container: タスクの実行環境を抽象化したもので、CPU、メモリなどの多次元資源や環境変数、起動コマンドなどタスク実行に関する情報をカプセル化します。

**Common**

　　Commonは、他のHadoopモジュールに基礎施設と常用のプログラム及びライブラリの集合を提供します。主にシステム設定ツールであるConfiguration、遠隔手続き呼び出し（Remote Procedure Call/RPC）、データの直列化、及びHadoop内部に抽象されるファイルシステム（FileSystem）などが含まれ、汎用ハードウェア上で環境を構築するための基本的なサービスを提供し、そのHadoop上で稼働するソフトウェア開発に必要なAPIを提供します。

　　簡単に言うと、Hadoop CommonはHadoopエコシステム全体の運用を支える基本的な構成であり、HDFS、MapReduce、およびYARNなどの他のモジュールが正常に動作し、協調して動作できるようにします。

## まとめ

　　Hadoopはビッグデータ領域に基礎施設として存在し、自身だけが全面の機能が備えてあるため相関の学習が多い。ただ実況でHadoopに対して操作の可能のところがHDFSまで十分です。特別MapReduce計算フレームワークが他の高性能の計算ソフトウェアSpark、Finkに差し替えられてあり、Yarnへの運行にも干渉しません。つまり、理論的な説明はたくさんありますが、実際に使われることは限ります。
